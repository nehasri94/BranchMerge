This is chapter 2 of master and with some more features
